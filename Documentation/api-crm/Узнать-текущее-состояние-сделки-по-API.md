# Узнать текущее состояние сделки по API

Команда «CRMLead.getLeadStatus» возвращает текущее состояние и последний комментарий по сделке.

## Параметры запроса

Адрес запроса: https://online.sbis.ru/service/

| Параметр | Тип | Описание |
|----------|-----|----------|
| ИдентификаторДокумента* | UUID | UUID документа. Уникальный идентификатор, который получен при создании сделки |

## Результат

| Параметр | Тип | Описание |
|----------|-----|----------|
| ИдентификаторДокумента | UUID | UUID-идентификатор документа в системе клиента |
| @Документ | integer | идентификатор документа в Saby. Целое число |
| Активность | boolean | флаг, который определяет статус сделки. Возможные значения: «False» — сделка новая, по ней нет событий, «True» — сделка в работе или завершена, есть события |
| Результат | boolean | результат сделки. Возможные значения: «True»/«False» — сделка завершена положительно/отрицательно, «None» — сделка не завершена |
| ПоследнийКомментарий | string | комментарий из последнего события по сделке либо комментарий из самой сделки |
| ДатаКомментария | date «ГГГГ.ММ.ДД ЧЧ:ММ:СС» | дата и время последнего события |
| АвторКомментария | UUID | UUID-идентификатор пользователя, который создал последнее событие |
| Ошибка | string | текст ошибки, если запрос не был выполнен |
| Статус | string | результат выполнения запроса. Возможные значения: «fail» — если в процессе поиска получили ошибку, «success» — если документ найден |

## Пример запроса

```json
{
  "jsonrpc": "2.0",
  "protocol": 6,
  "method": "CRMLead.getLeadStatus",
  "params": {
    "ИдентификаторДокумента": "487a90b0-73ad-4f87-90d8-c4474f6c8a13"
  },
  "id": 1
}
```

## Пример ответа

```json
{
  "jsonrpc": "2.0",
  "result": {
    "f": 0,
    "d": [
      "487a90b0-73ad-4f87-90d8-c4474f6c8a13",
      24337443,
      false,
      null,
      null,
      null,
      null,
      "",
      "success"
    ],
    "k": "@Документ",
    "s": [
      {
        "n": "ИдентификаторДокумента",
        "t": "UUID"
      },
      {
        "n": "@Документ",
        "t": "Число целое"
      },
      {
        "n": "Активность",
        "t": "Логическое"
      },
      {
        "n": "Результат",
        "t": "Логическое"
      },
      {
        "n": "ПоследнийКомментарий",
        "t": "Строка"
      },
      {
        "n": "ДатаКомментария",
        "t": "Дата и время"
      },
      {
        "n": "АвторКомментария",
        "t": "UUID"
      },
      {
        "n": "Ошибка",
        "t": "Строка"
      },
      {
        "n": "Статус",
        "t": "Строка"
      }
    ],
    "_type": "record"
  },
  "id": 1,
  "protocol": 6
}