# СБИС.Аутентифицировать

Команда «СБИС.Аутентифицировать» выполняет аутентификацию по логину и паролю, возвращает идентификатор сессии. Допускается не более 300 вызовов в минуту.

## Параметры запроса

В заголовке запроса укажите тип и кодировку: «content-type: application/json», «charset=UTF-8».

Адрес запроса: https://online.sbis.ru/auth/service/

- "Параметр": объект:
  - "Логин": строка
  - "Пароль": строка
  - "НомерАккаунта": строка. Указывается, если у пользователя есть доступ в разные кабинеты Saby по одному логину и паролю. Если номер не указан, будет выполнен вход в кабинет, где пользователь авторизовался последний раз.
    - Как посмотреть номер аккаунта?

## Результат

Строка — идентификатор сессии.

## Примеры

### Запрос без заполнения номера аккаунта

```json
{
   "jsonrpc": "2.0",
   "method": "СБИС.Аутентифицировать",
   "params": {
      "Параметр": {
         "Логин": "User",
         "Пароль": "Password"
      }
   },
   "id": 0
}
```

 

### Ответ

```json
{
   "jsonrpc": "2.0",
   "result": "000b8ee4-000b8ee5-00ba-a40615cd1a61453a",
   "id": 0
}
```

 

### Ответ с ошибкой аутентификации — неверный логин или пароль

```json
{
   "jsonrpc": "2.0",
   "error": {
      "code": -32000,
      "message": "Проверьте правильность ввода логина и пароля!",
      "details": "Проверьте правильность ввода логина и пароля!",
      "data": {
         "classid": "{00000000-0000-0000-0000-1FA000001001}",
         "addinfo": null
      }
   },
   "id": 0
}
```

 

### Ответ с фатальной ошибкой передачи входных параметров

HTTP код ответа 500, classid {00000000-0000-0000-0000-1FA000001001}. Означает, что не переданы нужные параметры или часть обязательных параметров пустая.

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32000,
    "message": "Ошибка аутентификации. Пустое значение поля Логин!",
    "details": "Ошибка аутентификации. Пустое значение поля Логин!",
    "data": {
      "classid": "{00000000-0000-0000-0000-1FA000001001}",
      "addinfo": null
    }
  },
  "id": 0
}
```

 

### Ответ при ошибке подтверждения аутентификации через смс

HTTP код ответа 500, classid {00000000-0000-0000-0000-1FA000001002}. В data.addinfo приходит информация для подтверждения входа:

- телефон — замаскированный телефонный номер, на который будет отправлено смс-подтверждение;
- идентификатор — временный идентификатор со сроком действия 5 минут, подтвердите его кодом из смс;
- МетодОтправкиКодаПодтверждения — метод для отправки смс-подтверждения;
- МетодПроверкиКодаИсключения — метод для подтверждения идентификатора кодом;
- ИдентификаторСессии — временный идентификатор сессии.

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32000,
    "message": "Требуется подтверждение действия",
    "details": "Требуется подтверждение действия",
    "data": {
      "classid": "{00000000-0000-0000-0000-1FA000001002}",
      "addinfo": {
        "Сообщение": "Для входа введите полученный код подтверждения.",
        "Телефон": "8(915)984-**-**",
        "Идентификатор": "dbef1dbb-1501-4f57-8783-0fc3f9c3b98d",
        "МетодОтправкиКодаПодтверждения": "СБИС.ОтправитьКодАутентификации",
        "МетодПроверкиКодаИсключения": "СБИС.ПодтвердитьВход",
        "ИдентификаторСессии": "00547bc6-0056d4a1-0bba-9a2cd69d2d804886"
      }
    }
  },
  "id": 0
}
```

 

### Ответ с фатальной ошибкой «Слишком много вызовов»

HTTP код ответа 429, classid {00000000-0000-0000-0000-1FA000001000}. Ошибка возникает, если система делает больше 300 вызовов в минуту.

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32000,
    "message": "Предупреждение! Метод вызывается слишком часто и будет заблокирован на 600 секунд",
    "details": "Предупреждение! Метод вызывается слишком часто и будет заблокирован на 600 секунд",
    "data": {
      "classid": "{00000000-0000-0000-0000-1FA000001000}",
      "addinfo": null
    }
  },
  "id": 0
}